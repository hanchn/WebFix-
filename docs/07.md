## 1. 缓存击穿（Cache Breakdown）

### 概念

**缓存击穿**指的是：**某一个热点数据（比如商品详情、热点榜单）在某一刻缓存失效了**，但有大量用户同时访问，所有请求就会在缓存失效后同时打到后端数据库。

### 例子

比如秒杀开始前，大家都在访问 `/product/1001`，这个商品详情本来有缓存，但缓存过期的一瞬间，成千上万请求都直接打到数据库，压力巨大，**有可能打垮DB**。

### 解决方法

* **互斥锁**：第一个请求“抢锁”去加载新数据，其余等待锁释放。
* **永不过期+异步刷新**：热点数据缓存不过期，后台定时异步更新。
* **提前预热**：大促前预先把热点数据写入缓存。

---

## 2. 缓存雪崩（Cache Avalanche）

### 概念

**缓存雪崩**指的是：**在某一时刻，大量缓存同时失效（如某类数据的缓存时间设置得太一致、服务重启导致缓存全清）**，导致成批的请求都直接打穿后端数据库。

### 例子

假如你设置了上万条商品缓存，全部在23:59:59过期，午夜零点一到，大量请求全打到数据库，后端雪崩，甚至引发连锁故障。

### 解决方法

* **缓存过期随机化**：设置缓存时间时加随机偏移，避免同一时刻大面积失效。
* **分批预热、批量重建**：分批重建失效缓存，避免同时过载。
* **多级缓存、限流熔断**：引入本地缓存、分布式限流、熔断保护。

---

## 3. 缓存脏读（Cache Dirty Read）

### 概念

**缓存脏读**指的是：**缓存里的数据已经和数据库里的数据不一致，用户读到过期或错误的缓存数据**。

### 例子

比如用户下单后，库存减少了，但缓存没及时更新，别人还看到老的库存，可能导致超卖等严重问题。

### 解决方法

* **写操作时主动更新或删除缓存**（cache aside/更新淘汰机制）
* **强一致性要求下可以采用消息队列同步、分布式事务等机制**
* **定期校验和补偿机制**，保证缓存与数据库最终一致

---

## 4. 总结一句话

> **缓存击穿**是热点单点失效，大量并发打DB；**缓存雪崩**是大面积缓存同一时刻失效，系统雪崩；**缓存脏读**是缓存与真实数据不一致，读到错误结果。


