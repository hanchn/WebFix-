## 1. 什么是心跳检测？

**心跳检测（Heartbeat）**，本质就是**一台机器/进程/服务定期给对方发送一个“我还活着”的信号**，以此证明它是健康可用、没有挂掉的。

* 这个信号就像人的心跳一样，**定期且持续**。
* 如果一段时间没收到心跳，通常就认为对方“失联”或“故障”了。

---

## 2. 为什么需要心跳检测？

* **健康监控**：及时发现节点、服务、进程的宕机、失联等问题。
* **高可用切换**：故障时可以自动进行主备切换、容灾转移。
* **分布式一致性**：判断成员是否存活，决定是否踢出集群或发起选举。
* **任务调度**：只有“活着”的节点才能分配新任务。

---

## 3. 心跳检测怎么实现？（实战角度）

### 常见实现方式

* **定时发送心跳包**：每隔几秒，节点A就向节点B发送一个特定的消息（如PING包）。
* **网络协议**：常见于 TCP/UDP 应用层（如Redis、MySQL主从同步），也可用HTTP短连接、WebSocket、gRPC等。
* **第三方中间件**：ZooKeeper、Consul、Etcd等注册中心天生支持心跳机制。
* **健康检查API**：服务定时访问对方健康检查接口（/health）。

### 关键参数

* **心跳间隔**（多久发一次，如5秒一次）
* **超时时间**（几次没收到就判定宕机，如3次未收到）

---

## 4. 典型应用场景举例

* **Redis Sentinel**：监控主节点心跳，主机挂了就自动选主切换。
* **K8s集群节点健康监控**：Kubelet定时发心跳给Master。
* **分布式任务调度器**：只有持续“心跳”的节点才会分配任务。
* **微服务健康检查**：Gateway定时探测后端服务健康状态。

---

## 5. 总结一句话

> **心跳检测就是用定时“我还活着”的消息，持续监控节点/服务/进程是否正常活着，发现异常能自动处理。**

